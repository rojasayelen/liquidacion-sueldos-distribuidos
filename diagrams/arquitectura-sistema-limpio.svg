<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1600 1000">
  <defs>
    <style>
      .title { font-family: Arial, sans-serif; font-size: 22px; font-weight: bold; fill: #333; }
      .subtitle { font-family: Arial, sans-serif; font-size: 13px; fill: #666; }
      .section-title { font-family: Arial, sans-serif; font-size: 15px; font-weight: bold; fill: #333; }
      .box-title { font-family: Arial, sans-serif; font-size: 13px; font-weight: bold; fill: #333; }
      .box-text { font-family: Arial, sans-serif; font-size: 11px; fill: #555; }
      .arrow { fill: none; stroke: #666; stroke-width: 2; marker-end: url(#arrowhead); }
      .arrow-dotted { fill: none; stroke: #999; stroke-width: 1.5; stroke-dasharray: 4,4; marker-end: url(#arrowhead-light); }
      .cliente-box { fill: #E3F2FD; stroke: #1976D2; stroke-width: 2; }
      .gateway-box { fill: #FFF3E0; stroke: #F57C00; stroke-width: 2; }
      .server-box { fill: #F3E5F5; stroke: #7B1FA2; stroke-width: 2; }
      .queue-box { fill: #E8F5E9; stroke: #388E3C; stroke-width: 2; }
      .worker-box { fill: #FCE4EC; stroke: #C2185B; stroke-width: 2; }
      .storage-box { fill: #FFF9C4; stroke: #F57F17; stroke-width: 2; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#666" />
    </marker>
    <marker id="arrowhead-light" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#999" />
    </marker>
  </defs>

  <!-- Título -->
  <text x="800" y="30" text-anchor="middle" class="title">ARQUITECTURA SISTEMA DISTRIBUIDO DE LIQUIDACIÓN DE SUELDOS</text>
  <text x="800" y="50" text-anchor="middle" class="subtitle">Cliente-Servidor | RabbitMQ | Workers Especializados | PostgreSQL</text>

  <!-- COLUMNA 1: CLIENTES -->
  <rect x="50" y="100" width="200" height="370" rx="10" class="cliente-box"/>
  <text x="150" y="125" text-anchor="middle" class="section-title">CLIENTES</text>
  
  <rect x="70" y="145" width="160" height="65" rx="5" fill="white" stroke="#1976D2" stroke-width="1"/>
  <text x="150" y="165" text-anchor="middle" class="box-title">Cliente Web</text>
  <text x="150" y="180" text-anchor="middle" class="box-text">Dashboard HTML/JS</text>
  <text x="150" y="195" text-anchor="middle" class="box-text">Puerto: 8080</text>
  
  <rect x="70" y="225" width="160" height="60" rx="5" fill="white" stroke="#1976D2" stroke-width="1"/>
  <text x="150" y="245" text-anchor="middle" class="box-title">Cliente Mobile</text>
  <text x="150" y="260" text-anchor="middle" class="box-text">Aplicación Móvil</text>
  
  <rect x="70" y="300" width="160" height="150" rx="5" fill="white" stroke="#1976D2" stroke-width="1"/>
  <text x="150" y="320" text-anchor="middle" class="box-title">Cliente Python</text>
  <text x="150" y="335" text-anchor="middle" class="box-text">Socket TCP Directo</text>
  <text x="150" y="350" text-anchor="middle" class="box-text">cliente.py</text>

  <!-- COLUMNA 2: GATEWAY API -->
  <rect x="310" y="130" width="190" height="120" rx="10" class="gateway-box"/>
  <text x="405" y="155" text-anchor="middle" class="section-title">GATEWAY API REST</text>
  <text x="405" y="180" text-anchor="middle" class="box-title">Flask</text>
  <text x="405" y="195" text-anchor="middle" class="box-text">Puerto: 5000</text>
  <text x="405" y="210" text-anchor="middle" class="box-text">Convierte HTTP → Socket</text>
  <text x="405" y="225" text-anchor="middle" class="box-text">rest_api.py</text>

  <!-- COLUMNA 3: SERVIDORES SOCKET -->
  <rect x="560" y="100" width="200" height="370" rx="10" class="server-box"/>
  <text x="660" y="125" text-anchor="middle" class="section-title">SERVIDORES SOCKET</text>
  
  <rect x="580" y="145" width="160" height="60" rx="5" fill="white" stroke="#7B1FA2" stroke-width="1"/>
  <text x="660" y="165" text-anchor="middle" class="box-title">Socket Server 1</text>
  <text x="660" y="180" text-anchor="middle" class="box-text">Puerto: 9001</text>
  <text x="660" y="195" text-anchor="middle" class="box-text">Pool de hilos</text>
  
  <rect x="580" y="220" width="160" height="60" rx="5" fill="white" stroke="#7B1FA2" stroke-width="1"/>
  <text x="660" y="240" text-anchor="middle" class="box-title">Socket Server 2</text>
  <text x="660" y="255" text-anchor="middle" class="box-text">Puerto: 9002</text>
  <text x="660" y="270" text-anchor="middle" class="box-text">Pool de hilos</text>
  
  <rect x="580" y="295" width="160" height="60" rx="5" fill="white" stroke="#7B1FA2" stroke-width="1"/>
  <text x="660" y="315" text-anchor="middle" class="box-title">Socket Server 3</text>
  <text x="660" y="330" text-anchor="middle" class="box-text">Puerto: 9003</text>
  <text x="660" y="345" text-anchor="middle" class="box-text">Pool de hilos</text>

  <!-- COLUMNA 4: RABBITMQ -->
  <rect x="820" y="100" width="200" height="370" rx="10" class="queue-box"/>
  <text x="920" y="125" text-anchor="middle" class="section-title">RABBITMQ</text>
  <text x="920" y="142" text-anchor="middle" class="box-text">Puerto: 5672</text>
  
  <rect x="840" y="160" width="160" height="45" rx="5" fill="white" stroke="#388E3C" stroke-width="1"/>
  <text x="920" y="185" text-anchor="middle" class="box-title">Cola: liquidacion</text>
  
  <rect x="840" y="220" width="160" height="45" rx="5" fill="white" stroke="#388E3C" stroke-width="1"/>
  <text x="920" y="245" text-anchor="middle" class="box-title">Cola: reportes</text>
  
  <rect x="840" y="280" width="160" height="45" rx="5" fill="white" stroke="#388E3C" stroke-width="1"/>
  <text x="920" y="305" text-anchor="middle" class="box-title">Cola: archivos_bancarios</text>
  
  <rect x="840" y="340" width="160" height="45" rx="5" fill="white" stroke="#388E3C" stroke-width="1"/>
  <text x="920" y="365" text-anchor="middle" class="box-title">Cola: cargas_sociales</text>

  <!-- COLUMNA 5: WORKERS -->
  <rect x="1080" y="100" width="200" height="370" rx="10" class="worker-box"/>
  <text x="1180" y="125" text-anchor="middle" class="section-title">WORKERS</text>
  
  <rect x="1100" y="145" width="160" height="60" rx="5" fill="white" stroke="#C2185B" stroke-width="1"/>
  <text x="1180" y="165" text-anchor="middle" class="box-title">Worker Liquidación</text>
  <text x="1180" y="180" text-anchor="middle" class="box-text">Pool: 5 hilos</text>
  <text x="1180" y="195" text-anchor="middle" class="box-text">Cálculo de sueldos</text>
  
  <rect x="1100" y="220" width="160" height="60" rx="5" fill="white" stroke="#C2185B" stroke-width="1"/>
  <text x="1180" y="240" text-anchor="middle" class="box-title">Worker Reportes</text>
  <text x="1180" y="255" text-anchor="middle" class="box-text">Pool: 5 hilos</text>
  <text x="1180" y="270" text-anchor="middle" class="box-text">Generación de PDFs</text>
  
  <rect x="1100" y="295" width="160" height="60" rx="5" fill="white" stroke="#C2185B" stroke-width="1"/>
  <text x="1180" y="315" text-anchor="middle" class="box-title">Worker Archivos</text>
  <text x="1180" y="330" text-anchor="middle" class="box-text">Pool: 3 hilos</text>
  <text x="1180" y="345" text-anchor="middle" class="box-text">Archivos bancarios TXT</text>
  
  <rect x="1100" y="370" width="160" height="60" rx="5" fill="white" stroke="#C2185B" stroke-width="1"/>
  <text x="1180" y="390" text-anchor="middle" class="box-title">Worker Cargas</text>
  <text x="1180" y="405" text-anchor="middle" class="box-text">Pool: 3 hilos</text>
  <text x="1180" y="420" text-anchor="middle" class="box-text">Cargas sociales ARCA</text>

  <!-- COLUMNA 6: ALMACENAMIENTO -->
  <rect x="1340" y="100" width="210" height="370" rx="10" class="storage-box"/>
  <text x="1445" y="125" text-anchor="middle" class="section-title">ALMACENAMIENTO</text>
  
  <rect x="1360" y="160" width="170" height="85" rx="5" fill="white" stroke="#F57F17" stroke-width="1"/>
  <text x="1445" y="185" text-anchor="middle" class="box-title">PostgreSQL</text>
  <text x="1445" y="200" text-anchor="middle" class="box-text">Puerto: 5432</text>
  <text x="1445" y="215" text-anchor="middle" class="box-text">Base de Datos</text>
  <text x="1445" y="230" text-anchor="middle" class="box-text">Liquidaciones, Tareas</text>
  
  <rect x="1360" y="265" width="170" height="70" rx="5" fill="white" stroke="#F57F17" stroke-width="1"/>
  <text x="1445" y="290" text-anchor="middle" class="box-title">MinIO / S3</text>
  <text x="1445" y="305" text-anchor="middle" class="box-text">Almacenamiento</text>
  <text x="1445" y="320" text-anchor="middle" class="box-text">de archivos</text>

  <!-- FLECHAS: Clientes Web/Mobile a API -->
  <path d="M 230,177 L 310,190" class="arrow"/>
  <path d="M 230,255 L 310,190" class="arrow"/>

  <!-- FLECHAS: API a Server 1 -->
  <path d="M 500,190 L 560,175" class="arrow"/>

  <!-- FLECHAS: Cliente Python a Servers (directas y punteadas) -->
  <path d="M 230,375 L 560,175" class="arrow"/>
  <path d="M 230,375 L 560,250" class="arrow-dotted"/>
  <path d="M 230,375 L 560,325" class="arrow-dotted"/>

  <!-- FLECHAS: Server 1 a todas las colas -->
  <path d="M 740,175 L 840,182" class="arrow"/>
  <path d="M 740,175 L 840,242" class="arrow"/>
  <path d="M 740,175 L 840,302" class="arrow"/>
  <path d="M 740,175 L 840,362" class="arrow"/>

  <!-- FLECHAS: Server 2 a todas las colas (punteadas) -->
  <path d="M 740,250 L 840,182" class="arrow-dotted"/>
  <path d="M 740,250 L 840,242" class="arrow-dotted"/>
  <path d="M 740,250 L 840,302" class="arrow-dotted"/>
  <path d="M 740,250 L 840,362" class="arrow-dotted"/>

  <!-- FLECHAS: Server 3 a todas las colas (punteadas) -->
  <path d="M 740,325 L 840,182" class="arrow-dotted"/>
  <path d="M 740,325 L 840,242" class="arrow-dotted"/>
  <path d="M 740,325 L 840,302" class="arrow-dotted"/>
  <path d="M 740,325 L 840,362" class="arrow-dotted"/>

  <!-- FLECHAS: Colas a Workers -->
  <path d="M 1000,182 L 1100,175" class="arrow"/>
  <path d="M 1000,242 L 1100,250" class="arrow"/>
  <path d="M 1000,302 L 1100,325" class="arrow"/>
  <path d="M 1000,362 L 1100,400" class="arrow"/>

  <!-- FLECHAS: Workers a PostgreSQL -->
  <path d="M 1260,175 L 1360,205" class="arrow"/>
  <path d="M 1260,250 L 1360,205" class="arrow"/>
  <path d="M 1260,325 L 1360,205" class="arrow"/>
  <path d="M 1260,400 L 1360,205" class="arrow"/>

  <!-- FLECHAS: Workers a S3 -->
  <path d="M 1260,175 L 1360,300" class="arrow"/>
  <path d="M 1260,250 L 1360,300" class="arrow"/>
  <path d="M 1260,325 L 1360,300" class="arrow"/>
  <path d="M 1260,400 L 1360,300" class="arrow"/>

  <!-- FLUJO DE DATOS -->
  <rect x="50" y="520" width="1500" height="130" rx="8" fill="#f5f5f5" stroke="#999" stroke-width="1"/>
  <text x="60" y="545" class="box-title">Flujo de datos:</text>
  
  <text x="60" y="570" class="box-text">1. Clientes Web/Mobile → API REST (HTTP) → Socket Servers (TCP) → RabbitMQ (Publica tareas en colas)</text>
  <text x="60" y="590" class="box-text">2. Cliente Python → Socket Servers directamente (TCP) → RabbitMQ (Publica tareas en colas)</text>
  <text x="60" y="610" class="box-text">3. Socket Servers → RabbitMQ (Los 3 servidores pueden publicar en cualquier cola según el tipo de tarea)</text>
  <text x="60" y="630" class="box-text">4. Workers → Consumen de su cola asignada → Procesan en paralelo → Guardan resultados en PostgreSQL/S3</text>

  <!-- LEYENDA -->
  <rect x="50" y="680" width="1500" height="80" rx="8" fill="#f5f5f5" stroke="#999" stroke-width="1"/>
  <text x="60" y="705" class="box-title">Componentes clave:</text>
  
  <text x="60" y="725" class="box-text">• Servidores Socket (9001-9003): Reciben tareas y las publican en RabbitMQ según tipo</text>
  <text x="60" y="742" class="box-text">• Workers Especializados: Cada worker consume de una cola específica y procesa en paralelo (pool de hilos)</text>
  <text x="800" y="725" class="box-text">• PostgreSQL: Base de datos principal (liquidaciones, empleados, empresas, tareas)</text>
  <text x="800" y="742" class="box-text">• MinIO/S3: Almacenamiento de archivos generados (PDFs, TXTs bancarios, reportes)</text>

  <!-- NOTA TÉCNICA -->
  <rect x="50" y="790" width="1500" height="60" rx="8" fill="#fff9c4" stroke="#F57F17" stroke-width="1"/>
  <text x="60" y="815" class="box-title">Nota técnica:</text>
  <text x="60" y="835" class="box-text">Las flechas sólidas representan el flujo principal. Las flechas punteadas indican conexiones alternativas/redundantes para alta disponibilidad.</text>
</svg>
